package com.example.jdbcExample;

import java.awt.List;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.util.ArrayList;

public class StudentDAO {

	private ArrayList students = null;
	private Connection con = null;

	public StudentDAO() throws ClassNotFoundException, SQLException {

		students = new ArrayList();
		Class.forName("org.postgresql.Driver");
		con = DriverManager
				.getConnection("jdbc:postgresql://localhost:5432/Lab1");
		Statement st = con.createStatement();
		ResultSet rs = st.executeQuery("SELECT * FROM Students");

		while (rs.next())
			students.add(new Student(rs.getInt("id"), rs
					.getString("first_name"), rs.getString("last_name")));
		rs.close();
	}

	@Override
	protected void finalize() throws Throwable {
		super.finalize();
		con.close();
		con = null;
		students.clear();
		students = null;
	}
	
	
}
