package com.example.jdbcExample;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.util.ArrayList;
import java.util.List;

public class StudentDAO {

	private List<Student> students = null;
	private Connection con = null;

	public StudentDAO() throws ClassNotFoundException, SQLException {

		students = new ArrayList<Student>();
		Class.forName("org.postgresql.Driver");
		con = DriverManager
				.getConnection("jdbc:postgresql://localhost:5432/Lab1");
		Statement st = con.createStatement();
		ResultSet rs = st.executeQuery("SELECT * FROM Students");

		while (rs.next())
			students.add(new Student(rs.getInt("id"), rs
					.getString("first_name"), rs.getString("last_name")));
		rs.close();
	}

	public String listStudents()	{

		StringBuilder sb = new StringBuilder();
		sb.append("<table>");
		sb.append("<tr>");
		sb.append("<th>");
		sb.append("ID");
		sb.append("</th>");
		sb.append("<th>");
		sb.append("First Name");
		sb.append("</th>");
		sb.append("<th>");
		sb.append("Last Name");
		sb.append("</th>");
		sb.append("</tr>");
		sb.append("</table>");
		
		for(Student i : students)	{

			sb.append("<tr>");
			sb.append("<td>");
			sb.append("ID");
			sb.append("</td>");
			sb.append("<td>");
			sb.append("First Name");
			sb.append("</td>");
			sb.append("<td>");
			sb.append("Last Name");
			sb.append("</td>");
			sb.append("</tr>");
			
		}
		
	}
	
	@Override
	protected void finalize() throws Throwable {
		super.finalize();
		con.close();
		con = null;
		students.clear();
		students = null;
	}
	
}
